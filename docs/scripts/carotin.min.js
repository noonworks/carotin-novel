!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=30)}([function(t,e,n){var i=n(21),o=[n(23),n(24),n(25),n(26)];t.exports=i.createStore(o,[])},function(t,e,n){"use strict";var i=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===o}(t)}(t)};var o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(t,e){return!1!==e.clone&&e.isMergeableObject(t)?u((n=t,Array.isArray(n)?[]:{}),t,e):t;var n}function s(t,e,n){return t.concat(e).map(function(t){return r(t,n)})}function a(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return t.propertyIsEnumerable(e)}):[]}(t))}function c(t,e,n){var i={};return n.isMergeableObject(t)&&a(t).forEach(function(e){i[e]=r(t[e],n)}),a(e).forEach(function(o){n.isMergeableObject(e[o])&&t[o]?i[o]=function(t,e){if(!e.customMerge)return u;var n=e.customMerge(t);return"function"==typeof n?n:u}(o,n)(t[o],e[o],n):i[o]=r(e[o],n)}),i}function u(t,e,n){(n=n||{}).arrayMerge=n.arrayMerge||s,n.isMergeableObject=n.isMergeableObject||i;var o=Array.isArray(e);return o===Array.isArray(t)?o?n.arrayMerge(t,e,n):c(t,e,n):r(e,n)}u.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,n){return u(t,n,e)},{})};var l=u;t.exports=l},function(t,e,n){(function(e){var n=Object.assign?Object.assign:function(t,e,n,i){for(var o=1;o<arguments.length;o++)a(Object(arguments[o]),function(e,n){t[n]=e});return t},i=function(){if(Object.create)return function(t,e,i,o){var r=s(arguments,1);return n.apply(this,[Object.create(t)].concat(r))};{function t(){}return function(e,i,o,r){var a=s(arguments,1);return t.prototype=e,n.apply(this,[new t].concat(a))}}}(),o=String.prototype.trim?function(t){return String.prototype.trim.call(t)}:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},r="undefined"!=typeof window?window:e;function s(t,e){return Array.prototype.slice.call(t,e||0)}function a(t,e){c(t,function(t,n){return e(t,n),!1})}function c(t,e){if(u(t)){for(var n=0;n<t.length;n++)if(e(t[n],n))return t[n]}else for(var i in t)if(t.hasOwnProperty(i)&&e(t[i],i))return t[i]}function u(t){return null!=t&&"function"!=typeof t&&"number"==typeof t.length}t.exports={assign:n,create:i,trim:o,bind:function(t,e){return function(){return e.apply(t,Array.prototype.slice.call(arguments,0))}},slice:s,each:a,map:function(t,e){var n=u(t)?[]:{};return c(t,function(t,i){return n[i]=e(t,i),!1}),n},pluck:c,isList:u,isFunction:function(t){return t&&"[object Function]"==={}.toString.call(t)},isObject:function(t){return t&&"[object Object]"==={}.toString.call(t)},Global:r}}).call(this,n(22))},function(t,e,n){"use strict";var i=n(5),o="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),r=Object.prototype.toString,s=Array.prototype.concat,a=Object.defineProperty,c=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),u=function(t,e,n,i){var o;e in t&&("function"!=typeof(o=i)||"[object Function]"!==r.call(o)||!i())||(c?a(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},l=function(t,e){var n=arguments.length>2?arguments[2]:{},r=i(e);o&&(r=s.call(r,Object.getOwnPropertySymbols(e)));for(var a=0;a<r.length;a+=1)u(t,r[a],e[r[a]],n[r[a]])};l.supportsDescriptors=!!c,t.exports=l},function(t,e,n){var i=n(5),o=n(12),r=n(13),s=n(14),a=n(18),c=n(20),u=Date.prototype.getTime;function l(t,e,n){var h=n||{};return!(h.strict?!r(t,e):t!==e)||(!t||!e||"object"!=typeof t&&"object"!=typeof e?h.strict?r(t,e):t==e:function(t,e,n){var r,h;if(typeof t!=typeof e)return!1;if(p(t)||p(e))return!1;if(t.prototype!==e.prototype)return!1;if(o(t)!==o(e))return!1;var f=s(t),m=s(e);if(f!==m)return!1;if(f||m)return t.source===e.source&&a(t)===a(e);if(c(t)&&c(e))return u.call(t)===u.call(e);var y=d(t),g=d(e);if(y!==g)return!1;if(y||g){if(t.length!==e.length)return!1;for(r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}if(typeof t!=typeof e)return!1;try{var v=i(t),b=i(e)}catch(t){return!1}if(v.length!==b.length)return!1;for(v.sort(),b.sort(),r=v.length-1;r>=0;r--)if(v[r]!=b[r])return!1;for(r=v.length-1;r>=0;r--)if(h=v[r],!l(t[h],e[h],n))return!1;return!0}(t,e,h))}function p(t){return null==t}function d(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}t.exports=l},function(t,e,n){"use strict";var i=Array.prototype.slice,o=n(6),r=Object.keys,s=r?function(t){return r(t)}:n(11),a=Object.keys;s.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return o(t)?a(i.call(t)):a(t)}):Object.keys=s;return Object.keys||s},t.exports=s},function(t,e,n){"use strict";var i=Object.prototype.toString;t.exports=function(t){var e=i.call(t),n="[object Arguments]"===e;return n||(n="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===i.call(t.callee)),n}},function(t,e,n){"use strict";var i=Object,o=TypeError;t.exports=function(){if(null!=this&&this!==i(this))throw new o("RegExp.prototype.flags getter called on non-object");var t="";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t}},function(t,e,n){"use strict";var i=n(7),o=n(3).supportsDescriptors,r=Object.getOwnPropertyDescriptor,s=TypeError;t.exports=function(){if(!o)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var t=r(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof/a/.dotAll)return t.get}return i}},function(t,e,n){window,t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var i,o=function(t,e){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},r=function(t){return t*(Math.PI/180)},s=function(t,e,n){for(var i,o=e.split(/[ ,]+/g),r=0;r<o.length;r+=1)i=o[r],t.addEventListener?t.addEventListener(i,n,!1):t.attachEvent&&t.attachEvent(i,n)},a=function(t,e,n){for(var i,o=e.split(/[ ,]+/g),r=0;r<o.length;r+=1)i=o[r],t.removeEventListener?t.removeEventListener(i,n):t.detachEvent&&t.detachEvent(i,n)},c=function(t){return t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t},u=function(){return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},l=function(t,e){e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},p=function(t,e,n){var i=d(t);for(var o in i)if(i.hasOwnProperty(o))if("string"==typeof e)i[o]=e+" "+n;else{for(var r="",s=0,a=e.length;s<a;s+=1)r+=e[s]+" "+n+", ";i[o]=r.slice(0,-2)}return i},d=function(t){var e={};return e[t]="",["webkit","Moz","o"].forEach(function(n){e[n+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},h=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},f=function(t,e){if(t.length)for(var n=0,i=t.length;n<i;n+=1)e(t[n]);else e(t)},m=!!("ontouchstart"in window),y=!!window.PointerEvent,g=!!window.MSPointerEvent,v={start:"mousedown",move:"mousemove",end:"mouseup"},b={};function w(){}y?i={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:g?i={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:m?(i={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},b=v):i=v,w.prototype.on=function(t,e){var n,i=t.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var o=0;o<i.length;o+=1)n=i[o],this._handlers_[n]=this._handlers_[n]||[],this._handlers_[n].push(e);return this},w.prototype.off=function(t,e){return this._handlers_=this._handlers_||{},void 0===t?this._handlers_={}:void 0===e?this._handlers_[t]=null:this._handlers_[t]&&this._handlers_[t].indexOf(e)>=0&&this._handlers_[t].splice(this._handlers_[t].indexOf(e),1),this},w.prototype.trigger=function(t,e){var n,i=this,o=t.split(/[ ,]+/g);i._handlers_=i._handlers_||{};for(var r=0;r<o.length;r+=1)n=o[r],i._handlers_[n]&&i._handlers_[n].length&&i._handlers_[n].forEach(function(t){t.call(i,{type:n,target:i},e)})},w.prototype.config=function(t){this.options=this.defaults||{},t&&(this.options=function(t,e){var n={};for(var i in t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)?n[i]=e[i]:t.hasOwnProperty(i)&&(n[i]=t[i]);return n}(this.options,t))},w.prototype.bindEvt=function(t,e){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[e]=function(){"function"==typeof n["on"+e]?n["on"+e].apply(n,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},s(t,i[e],n._domHandlers_[e]),b[e]&&s(t,b[e],n._domHandlers_[e]),n},w.prototype.unbindEvt=function(t,e){return this._domHandlers_=this._domHandlers_||{},a(t,i[e],this._domHandlers_[e]),b[e]&&a(t,b[e],this._domHandlers_[e]),delete this._domHandlers_[e],this};var _=w;function x(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1},this.config(e),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=x.id,x.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}x.prototype=new _,x.constructor=x,x.id=0,x.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)},x.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=function(t,e){var n=d("borderRadius");for(var i in n)n.hasOwnProperty(i)&&(n[i]="50%");return n}(),n=p("transition","opacity",t),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},h(i.el,n),h(i.back,e),h(i.front,e),this.applyStyles(i),this},x.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var n in t[e])this.ui[e].style[n]=t[e][n];return this},x.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)},x.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)},x.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},x.prototype.show=function(t){var e=this;return e.options.dataOnly?e:(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),"function"==typeof t&&t.call(this)},e.options.fadeTime),e)},x.prototype.hide=function(t){var e=this;return e.options.dataOnly?e:(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var n="dynamic"===e.options.mode?"none":"block";e.ui.el.style.display=n,"function"==typeof t&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick&&e.restPosition(),e)},x.prototype.restPosition=function(t){var e=this;e.frontPosition={x:0,y:0};var n=e.options.fadeTime+"ms",i={};i.front=p("transition",["top","left"],n);var o={front:{}};o.front={left:e.frontPosition.x+"px",top:e.frontPosition.y+"px"},e.applyStyles(i),e.applyStyles(o),e.restTimeout=setTimeout(function(){"function"==typeof t&&t.call(e),e.restCallback()},e.options.fadeTime)},x.prototype.restCallback=function(){var t={};t.front=p("transition","none",""),this.applyStyles(t),this.trigger("rested",this.instance)},x.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},x.prototype.computeDirection=function(t){var e,n,i,o=t.angle.radian,r=Math.PI/4,s=Math.PI/2;if(o>r&&o<3*r&&!t.lockX?e="up":o>-r&&o<=r&&!t.lockY?e="left":o>3*-r&&o<=-r&&!t.lockX?e="down":t.lockY||(e="right"),t.lockY||(n=o>-s&&o<s?"left":"right"),t.lockX||(i=o>0?"up":"down"),t.force>this.options.threshold){var a,c={};for(a in this.direction)this.direction.hasOwnProperty(a)&&(c[a]=this.direction[a]);var u={};for(a in this.direction={x:n,y:i,angle:e},t.direction=this.direction,c)c[a]===this.direction[a]&&(u[a]=!0);if(u.x&&u.y&&u.angle)return t;u.x&&u.y||this.trigger("plain",t),u.x||this.trigger("plain:"+n,t),u.y||this.trigger("plain:"+i,t),u.angle||this.trigger("dir dir:"+e,t)}else this.resetDirection();return t};var O=x;function S(t,e){return this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=t,this.id=S.id,S.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1},this.config(e),"static"!==this.options.mode&&"semi"!==this.options.mode||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}S.prototype=new _,S.constructor=S,S.id=0,S.prototype.prepareNipples=function(){var t=this.nipples;t.on=this.on.bind(this),t.off=this.off.bind(this),t.options=this.options,t.destroy=this.destroy.bind(this),t.ids=this.ids,t.id=this.id,t.processOnMove=this.processOnMove.bind(this),t.processOnEnd=this.processOnEnd.bind(this),t.get=function(e){if(void 0===e)return t[0];for(var n=0,i=t.length;n<i;n+=1)if(t[n].identifier===e)return t[n];return!1}},S.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},S.prototype.begin=function(){var t=this.options;if("static"===t.mode){var e=this.createNipple(t.position,this.manager.getIdentifier());e.add(),this.idles.push(e)}},S.prototype.createNipple=function(t,e){var n=u(),i={},o=this.options;if(t.x&&t.y)i={x:t.x-(n.x+this.box.left),y:t.y-(n.y+this.box.top)};else if(t.top||t.right||t.bottom||t.left){var r=document.createElement("DIV");r.style.display="hidden",r.style.top=t.top,r.style.right=t.right,r.style.bottom=t.bottom,r.style.left=t.left,r.style.position="absolute",o.zone.appendChild(r);var s=r.getBoundingClientRect();o.zone.removeChild(r),i=t,t={x:s.left+n.x,y:s.top+n.y}}var a=new O(this,{color:o.color,size:o.size,threshold:o.threshold,fadeTime:o.fadeTime,dataOnly:o.dataOnly,restJoystick:o.restJoystick,restOpacity:o.restOpacity,mode:o.mode,identifier:e,position:t,zone:o.zone,frontPosition:{x:0,y:0}});return o.dataOnly||(l(a.ui.el,i),l(a.ui.front,a.frontPosition)),this.nipples.push(a),this.trigger("added "+a.identifier+":added",a),this.manager.trigger("added "+a.identifier+":added",a),this.bindNipple(a),a},S.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},S.prototype.bindNipple=function(t){var e,n=this,i=function(t,i){e=t.type+" "+i.id+":"+t.type,n.trigger(e,i)};t.on("destroyed",n.onDestroyed.bind(n)),t.on("shown hidden rested dir plain",i),t.on("dir:up dir:right dir:down dir:left",i),t.on("plain:up plain:right plain:down plain:left",i)},S.prototype.pressureFn=function(t,e,n){var i=this,o=0;clearInterval(i.pressureIntervals[n]),i.pressureIntervals[n]=setInterval(function(){var n=t.force||t.pressure||t.webkitForce||0;n!==o&&(e.trigger("pressure",n),i.trigger("pressure "+e.identifier+":pressure",n),o=n)}.bind(i),100)},S.prototype.onstart=function(t){var e=this,n=e.options,i=t;return t=c(t),e.updateBox(),f(t,function(o){e.actives.length<n.maxNumberOfNipples?e.processOnStart(o):i.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(n){if(Object.values(i.touches).findIndex(function(t){return t.identifier===n})<0){var o=[t[0]];o.identifier=n,e.processOnEnd(o)}}),e.actives.length<n.maxNumberOfNipples&&e.processOnStart(o))}),e.manager.bindDocument(),!1},S.prototype.processOnStart=function(t){var e,n=this,i=n.options,r=n.manager.getIdentifier(t),s=t.force||t.pressure||t.webkitForce||0,a={x:t.pageX,y:t.pageY},c=n.getOrCreate(r,a);c.identifier!==r&&n.manager.removeIdentifier(c.identifier),c.identifier=r;var u=function(e){e.trigger("start",e),n.trigger("start "+e.id+":start",e),e.show(),s>0&&n.pressureFn(t,e,e.identifier),n.processOnMove(t)};if((e=n.idles.indexOf(c))>=0&&n.idles.splice(e,1),n.actives.push(c),n.ids.push(c.identifier),"semi"!==i.mode)u(c);else{if(!(o(a,c.position)<=i.catchDistance))return c.destroy(),void n.processOnStart(t);u(c)}return c},S.prototype.getOrCreate=function(t,e){var n,i=this.options;return/(semi|static)/.test(i.mode)?(n=this.idles[0])?(this.idles.splice(0,1),n):"semi"===i.mode?this.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1):n=this.createNipple(e,t)},S.prototype.processOnMove=function(t){var e=this.options,n=this.manager.getIdentifier(t),i=this.nipples.get(n);if(function(t){return isNaN(t.buttons)?0!==t.pressure:0!==t.buttons}(t)){if(!i)return console.error("Found zombie joystick with ID "+n),void this.manager.removeIdentifier(n);i.identifier=n;var s=i.options.size/2,a={x:t.pageX,y:t.pageY};e.lockX&&(a.y=i.position.y),e.lockY&&(a.x=i.position.x);var c,u,p,d,h,f,m,y,g=o(a,i.position),v=(c=a,p=(u=i.position).x-c.x,d=u.y-c.y,function(t){return t*(180/Math.PI)}(Math.atan2(d,p))),b=r(v),w=g/s,_={distance:g,position:a};g>s&&(g=s,h=i.position,f=g,y={x:0,y:0},m=r(m=v),y.x=h.x-f*Math.cos(m),y.y=h.y-f*Math.sin(m),a=y);var x=a.x-i.position.x,O=a.y-i.position.y;i.frontPosition={x:x,y:O},e.dataOnly||l(i.ui.front,i.frontPosition);var S={identifier:i.identifier,position:a,force:w,pressure:t.force||t.pressure||t.webkitForce||0,distance:g,angle:{radian:b,degree:v},raw:_,instance:i,lockX:e.lockX,lockY:e.lockY};(S=i.computeDirection(S)).angle={radian:r(180-v),degree:180-v},i.trigger("move",S),this.trigger("move "+i.id+":move",S)}else this.processOnEnd(t)},S.prototype.processOnEnd=function(t){var e=this,n=e.options,i=e.manager.getIdentifier(t),o=e.nipples.get(i),r=e.manager.removeIdentifier(o.identifier);o&&(n.dataOnly||o.hide(function(){"dynamic"===n.mode&&(o.trigger("removed",o),e.trigger("removed "+o.id+":removed",o),e.manager.trigger("removed "+o.id+":removed",o),o.destroy())}),clearInterval(e.pressureIntervals[o.identifier]),o.resetDirection(),o.trigger("end",o),e.trigger("end "+o.id+":end",o),e.ids.indexOf(o.identifier)>=0&&e.ids.splice(e.ids.indexOf(o.identifier),1),e.actives.indexOf(o)>=0&&e.actives.splice(e.actives.indexOf(o),1),/(semi|static)/.test(n.mode)?e.idles.push(o):e.nipples.indexOf(o)>=0&&e.nipples.splice(e.nipples.indexOf(o),1),e.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(e.manager.ids[r.id]=r.identifier))},S.prototype.onDestroyed=function(t,e){this.nipples.indexOf(e)>=0&&this.nipples.splice(this.nipples.indexOf(e),1),this.actives.indexOf(e)>=0&&this.actives.splice(this.actives.indexOf(e),1),this.idles.indexOf(e)>=0&&this.idles.splice(this.idles.indexOf(e),1),this.ids.indexOf(e.identifier)>=0&&this.ids.splice(this.ids.indexOf(e.identifier),1),this.manager.removeIdentifier(e.identifier),this.manager.unbindDocument()},S.prototype.destroy=function(){for(var t in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach(function(t){t.destroy()}),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(t)&&clearInterval(this.pressureIntervals[t]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var D=S;function k(t){var e,n=this;return n.ids={},n.index=0,n.collections=[],n.config(t),n.prepareCollections(),s(window,"resize",function(t){clearTimeout(e),e=setTimeout(function(){var t,e=u();n.collections.forEach(function(n){n.forEach(function(n){t=n.el.getBoundingClientRect(),n.position={x:e.x+t.left,y:e.y+t.top}})})},100)}),n.collections}k.prototype=new _,k.constructor=k,k.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var n;return t.collections.every(function(t){return!(n=t.get(e))}),n}},k.prototype.create=function(t){return this.createCollection(t)},k.prototype.createCollection=function(t){var e=new D(this,t);return this.bindCollection(e),this.collections.push(e),e},k.prototype.bindCollection=function(t){var e,n=this,i=function(t,i){e=t.type+" "+i.id+":"+t.type,n.trigger(e,i)};t.on("destroyed",n.onDestroyed.bind(n)),t.on("shown hidden rested dir plain",i),t.on("dir:up dir:right dir:down dir:left",i),t.on("plain:up plain:right plain:down plain:left",i)},k.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},k.prototype.unbindDocument=function(t){Object.keys(this.ids).length&&!0!==t||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},k.prototype.getIdentifier=function(t){var e;return t?void 0===(e=void 0===t.identifier?t.pointerId:t.identifier)&&(e=this.latest||0):e=this.index,void 0===this.ids[e]&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]},k.prototype.removeIdentifier=function(t){var e={};for(var n in this.ids)if(this.ids[n]===t){e.id=n,e.identifier=this.ids[n],delete this.ids[n];break}return e},k.prototype.onmove=function(t){return this.onAny("move",t),!1},k.prototype.onend=function(t){return this.onAny("end",t),!1},k.prototype.oncancel=function(t){return this.onAny("end",t),!1},k.prototype.onAny=function(t,e){var n,i=this,o="processOn"+t.charAt(0).toUpperCase()+t.slice(1);return e=c(e),f(e,function(t){n=i.getIdentifier(t),f(i.collections,function(t,e,n){n.ids.indexOf(e)>=0&&(n[o](t),t._found_=!0)}.bind(null,t,n)),t._found_||i.removeIdentifier(n)}),!1},k.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach(function(t){t.destroy()}),this.off()},k.prototype.onDestroyed=function(t,e){if(this.collections.indexOf(e)<0)return!1;this.collections.splice(this.collections.indexOf(e),1)};var E=new k;e.default={create:function(t){return E.create(t)},factory:E}}]).default},function(t,e){t.exports=function(){var t={};return{defaults:function(e,n){t=n},get:function(e,n){var i=e();return void 0!==i?i:t[n]}}}},function(t,e,n){"use strict";var i;if(!Object.keys){var o=Object.prototype.hasOwnProperty,r=Object.prototype.toString,s=n(6),a=Object.prototype.propertyIsEnumerable,c=!a.call({toString:null},"toString"),u=a.call(function(){},"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(t){var e=t.constructor;return e&&e.prototype===t},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&o.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{p(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();i=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===r.call(t),i=s(t),a=e&&"[object String]"===r.call(t),d=[];if(!e&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var f=u&&n;if(a&&t.length>0&&!o.call(t,0))for(var m=0;m<t.length;++m)d.push(String(m));if(i&&t.length>0)for(var y=0;y<t.length;++y)d.push(String(y));else for(var g in t)f&&"prototype"===g||!o.call(t,g)||d.push(String(g));if(c)for(var v=function(t){if("undefined"==typeof window||!h)return p(t);try{return p(t)}catch(t){return!1}}(t),b=0;b<l.length;++b)v&&"constructor"===l[b]||!o.call(t,l[b])||d.push(l[b]);return d}}t.exports=i},function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,o=Object.prototype.toString,r=function(t){return!(i&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===o.call(t)},s=function(t){return!!r(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==o.call(t)&&"[object Function]"===o.call(t.callee)},a=function(){return r(arguments)}();r.isLegacyArguments=s,t.exports=a?r:s},function(t,e,n){"use strict";var i=function(t){return t!=t};t.exports=function(t,e){return 0===t&&0===e?1/t==1/e:t===e||!(!i(t)||!i(e))}},function(t,e,n){"use strict";var i=n(15),o=RegExp.prototype.exec,r=Object.getOwnPropertyDescriptor,s=Object.prototype.toString,a="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(t){if(!t||"object"!=typeof t)return!1;if(!a)return"[object RegExp]"===s.call(t);var e=r(t,"lastIndex");return!(!e||!i(e,"value"))&&function(t){try{var e=t.lastIndex;return t.lastIndex=0,o.call(t),!0}catch(t){return!1}finally{t.lastIndex=e}}(t)}},function(t,e,n){"use strict";var i=n(16);t.exports=i.call(Function.call,Object.prototype.hasOwnProperty)},function(t,e,n){"use strict";var i=n(17);t.exports=Function.prototype.bind||i},function(t,e,n){"use strict";var i="Function.prototype.bind called on incompatible ",o=Array.prototype.slice,r=Object.prototype.toString;t.exports=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==r.call(e))throw new TypeError(i+e);for(var n,s=o.call(arguments,1),a=function(){if(this instanceof n){var i=e.apply(this,s.concat(o.call(arguments)));return Object(i)===i?i:this}return e.apply(t,s.concat(o.call(arguments)))},c=Math.max(0,e.length-s.length),u=[],l=0;l<c;l++)u.push("$"+l);if(n=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(a),e.prototype){var p=function(){};p.prototype=e.prototype,n.prototype=new p,p.prototype=null}return n}},function(t,e,n){"use strict";var i=n(3),o=n(7),r=n(8),s=n(19),a=Function.call.bind(o);i(a,{getPolyfill:r,implementation:o,shim:s}),t.exports=a},function(t,e,n){"use strict";var i=n(3).supportsDescriptors,o=n(8),r=Object.getOwnPropertyDescriptor,s=Object.defineProperty,a=TypeError,c=Object.getPrototypeOf,u=/a/;t.exports=function(){if(!i||!c)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=o(),e=c(u),n=r(e,"flags");return n&&n.get===t||s(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},function(t,e,n){"use strict";var i=Date.prototype.getDay,o=Object.prototype.toString,r="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(t){return"object"==typeof t&&null!==t&&(r?function(t){try{return i.call(t),!0}catch(t){return!1}}(t):"[object Date]"===o.call(t))}},function(t,e,n){var i=n(2),o=i.slice,r=i.pluck,s=i.each,a=i.bind,c=i.create,u=i.isList,l=i.isFunction,p=i.isObject;t.exports={createStore:h};var d={version:"2.0.12",enabled:!1,get:function(t,e){var n=this.storage.read(this._namespacePrefix+t);return this._deserialize(n,e)},set:function(t,e){return void 0===e?this.remove(t):(this.storage.write(this._namespacePrefix+t,this._serialize(e)),e)},remove:function(t){this.storage.remove(this._namespacePrefix+t)},each:function(t){var e=this;this.storage.each(function(n,i){t.call(e,e._deserialize(n),(i||"").replace(e._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(t){return this._namespacePrefix=="__storejs_"+t+"_"},createStore:function(){return h.apply(this,arguments)},addPlugin:function(t){this._addPlugin(t)},namespace:function(t){return h(this.storage,this.plugins,t)}};function h(t,e,n){n||(n=""),t&&!u(t)&&(t=[t]),e&&!u(e)&&(e=[e]);var i=n?"__storejs_"+n+"_":"",h=n?new RegExp("^"+i):null;if(!/^[a-zA-Z0-9_\-]*$/.test(n))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var f=c({_namespacePrefix:i,_namespaceRegexp:h,_testStorage:function(t){try{var e="__storejs__test__";t.write(e,e);var n=t.read(e)===e;return t.remove(e),n}catch(t){return!1}},_assignPluginFnProp:function(t,e){var n=this[e];this[e]=function(){var e=o(arguments,0),i=this;function r(){if(n)return s(arguments,function(t,n){e[n]=t}),n.apply(i,e)}var a=[r].concat(e);return t.apply(i,a)}},_serialize:function(t){return JSON.stringify(t)},_deserialize:function(t,e){if(!t)return e;var n="";try{n=JSON.parse(t)}catch(e){n=t}return void 0!==n?n:e},_addStorage:function(t){this.enabled||this._testStorage(t)&&(this.storage=t,this.enabled=!0)},_addPlugin:function(t){var e=this;if(u(t))s(t,function(t){e._addPlugin(t)});else if(!r(this.plugins,function(e){return t===e})){if(this.plugins.push(t),!l(t))throw new Error("Plugins must be function values that return objects");var n=t.call(this);if(!p(n))throw new Error("Plugins must return an object of function properties");s(n,function(n,i){if(!l(n))throw new Error("Bad plugin property: "+i+" from plugin "+t.name+". Plugins should only return functions.");e._assignPluginFnProp(n,i)})}},addStorage:function(t){!function(){var t="undefined"==typeof console?null:console;t&&(t.warn?t.warn:t.log).apply(t,arguments)}("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(t)}},d,{plugins:[]});return f.raw={},s(f,function(t,e){l(t)&&(f.raw[e]=a(f,t))}),s(t,function(t){f._addStorage(t)}),s(e,function(t){f._addPlugin(t)}),f}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i=n(2).Global;function o(){return i.localStorage}function r(t){return o().getItem(t)}t.exports={name:"localStorage",read:r,write:function(t,e){return o().setItem(t,e)},each:function(t){for(var e=o().length-1;e>=0;e--){var n=o().key(e);t(r(n),n)}},remove:function(t){return o().removeItem(t)},clearAll:function(){return o().clear()}}},function(t,e,n){var i=n(2).Global;function o(){return i.sessionStorage}function r(t){return o().getItem(t)}t.exports={name:"sessionStorage",read:r,write:function(t,e){return o().setItem(t,e)},each:function(t){for(var e=o().length-1;e>=0;e--){var n=o().key(e);t(r(n),n)}},remove:function(t){return o().removeItem(t)},clearAll:function(){return o().clear()}}},function(t,e,n){var i=n(2),o=i.Global,r=i.trim;t.exports={name:"cookieStorage",read:function(t){if(!t||!u(t))return null;var e="(?:^|.*;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(s.cookie.replace(new RegExp(e),"$1"))},write:function(t,e){if(!t)return;s.cookie=escape(t)+"="+escape(e)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},each:a,remove:c,clearAll:function(){a(function(t,e){c(e)})}};var s=o.document;function a(t){for(var e=s.cookie.split(/; ?/g),n=e.length-1;n>=0;n--)if(r(e[n])){var i=e[n].split("="),o=unescape(i[0]);t(unescape(i[1]),o)}}function c(t){t&&u(t)&&(s.cookie=escape(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function u(t){return new RegExp("(?:^|;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(s.cookie)}},function(t,e){t.exports={name:"memoryStorage",read:function(t){return n[t]},write:function(t,e){n[t]=e},each:function(t){for(var e in n)n.hasOwnProperty(e)&&t(n[e],e)},remove:function(t){delete n[t]},clearAll:function(t){n={}}};var n={}},,,,function(t,e,n){"use strict";n.r(e);var i=function(){function t(t){this._dom=t,this.setScrollEvent()}return Object.defineProperty(t.prototype,"scrollLeft",{get:function(){return this._dom.scrollLeft},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dom",{get:function(){return this._dom},enumerable:!0,configurable:!0}),t.prototype.scrollToLeft=function(t,e){this.scrollTo(this._dom.scrollLeft+t,e)},t.prototype.scrollTo=function(t,e){this._dom.scrollTo?this._dom.scrollTo({left:t,behavior:e?"smooth":"auto"}):this._dom.scrollLeft=t},t.prototype.setScrollEvent=function(){var t=this;this._dom.addEventListener("wheel",function(e){0==e.deltaX&&(e.stopPropagation(),e.preventDefault(),t.scrollToLeft(-1*e.deltaY,!1))},{passive:!1})},t}(),o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("width","44"),o.setAttribute("height","44"),o.setAttribute("viewBox","0 0 44 44"),o.setAttribute("xmlns","http://www.w3.org/2000/svg");var r=document.createElementNS("http://www.w3.org/2000/svg","g");r.setAttribute("fill","none"),r.setAttribute("fill-rule","evenodd"),r.setAttribute("stroke-width","2");var s=document.createElementNS("http://www.w3.org/2000/svg","circle");s.setAttribute("cx","22"),s.setAttribute("cy","22"),s.setAttribute("r","1.0");var a=document.createElementNS("http://www.w3.org/2000/svg","animate");a.setAttribute("attributeName","r"),a.setAttribute("begin","0s"),a.setAttribute("dur","1.8s"),a.setAttribute("values","1; 20"),a.setAttribute("calcMode","spline"),a.setAttribute("keyTimes","0; 1"),a.setAttribute("keySplines","0.165, 0.84, 0.44, 1"),a.setAttribute("repeatCount","indefinite");var c=document.createElementNS("http://www.w3.org/2000/svg","animate");c.setAttribute("attributeName","stroke-opacity"),c.setAttribute("begin","0s"),c.setAttribute("dur","1.8s"),c.setAttribute("values","1; 0"),c.setAttribute("calcMode","spline"),c.setAttribute("keyTimes","0; 1"),c.setAttribute("keySplines","0.3, 0.61, 0.355, 1"),c.setAttribute("repeatCount","indefinite"),s.appendChild(a),s.appendChild(c);var u=document.createElementNS("http://www.w3.org/2000/svg","circle");u.setAttribute("cx","22"),u.setAttribute("cy","22"),u.setAttribute("r","1.0");var l=document.createElementNS("http://www.w3.org/2000/svg","animate");l.setAttribute("attributeName","r"),l.setAttribute("begin","-0.9s"),l.setAttribute("dur","1.8s"),l.setAttribute("values","1; 20"),l.setAttribute("calcMode","spline"),l.setAttribute("keyTimes","0; 1"),l.setAttribute("keySplines","0.165, 0.84, 0.44, 1"),l.setAttribute("repeatCount","indefinite");var p=document.createElementNS("http://www.w3.org/2000/svg","animate");p.setAttribute("attributeName","stroke-opacity"),p.setAttribute("begin","-0.9s"),p.setAttribute("dur","1.8s"),p.setAttribute("values","1; 0"),p.setAttribute("calcMode","spline"),p.setAttribute("keyTimes","0; 1"),p.setAttribute("keySplines","0.3, 0.61, 0.355, 1"),p.setAttribute("repeatCount","indefinite"),u.appendChild(l),u.appendChild(p),r.appendChild(s),r.appendChild(u),o.appendChild(r);var d=function(){function t(t){this.wrapper=t,this.svgelements={circle:o}}return t.prototype.set=function(t){var e=this;this.wrapper.querySelectorAll("svg").forEach(function(t){e.wrapper.removeChild(t)}),this.wrapper.appendChild(this.svgelements[t])},t.prototype.show=function(){this.wrapper.classList.remove("off")},t.prototype.hide=function(){this.wrapper.classList.contains("off")||this.wrapper.classList.add("off")},t}(),h=function(){function t(t){this.animationId=-1,this.previousSpeed=0,this.speed=0,this.scrollStartPos=0,this.scrollStartDt=-1,this.wrapper=t}return t.prototype.start=function(){var t=this;window.cancelAnimationFrame(this.animationId),this.scrollStartPos=this.wrapper.scrollLeft,this.scrollStartDt=(new Date).getTime();var e=function(){t.draw(),t.animationId=window.requestAnimationFrame(e)};this.animationId=window.requestAnimationFrame(e)},t.prototype.stop=function(){window.cancelAnimationFrame(this.animationId),this.animationId=-1,this.resetSpeed(),this.scrollStartPos=0,this.scrollStartDt=-1},t.prototype.setSpeed=function(t,e){if(t&&t.direction&&t.distance){var n="up"==t.direction.y?1:-1,i=t.distance/e,o=Math.pow(i,2)*n;this.previousSpeed!=o&&(this.previousSpeed=this.speed,this.speed=o,this.start())}else this.resetSpeed()},t.prototype.resetSpeed=function(){this.previousSpeed=0,this.speed=0},t.prototype.draw=function(){if(!(this.scrollStartDt<0)){var t=(new Date).getTime()-this.scrollStartDt,e=this.scrollStartPos+this.speed*t;this.wrapper.scrollTo(e,!1)}},t}(),f=n(9),m=n.n(f);function y(t){var e;return(e=t.key,document.documentElement.style.getPropertyValue(e)!=t.val)&&(document.documentElement.style.setProperty(t.key,t.val),!0)}var g=/^--carotinnovel--/;var v=/^[ \t\r\n\s]*"([^"]*)"[ \t\r\n\s]*$/,b=/^[ \t\r\n\s]*'([^']*)'[ \t\r\n\s]*$/;function w(t){return t.replace(v,"$1").replace(b,"$1")}var _=/([^\]]*)\].*/;function x(t){for(var e=":root["+t+"=",n={},i=0;i<document.styleSheets.length&&!(document.styleSheets[i].type.indexOf("css")<0);i++){var o=document.styleSheets[i];try{for(var r=o.rules,s=0;s<r.length;s++){var a=r[s];if(a.selectorText&&0==a.selectorText.indexOf(e)){var c=w(a.selectorText.substring(e.length).replace(_,"$1"));n[c]&&n[c].length>0?n[c].push(a):n[c]=[a]}}}catch(t){break}}return Object.keys(n).map(function(t){return{dataValue:t,rules:n[t]}})}function O(t){for(var e,n={},i=0;i<t.length;i++)for(var o=t[i].style,r=0;r<o.length;r++){var s=o[r];n[(e=s,e.replace(g,""))]=w(o.getPropertyValue(s))}return n}function S(t){return document.documentElement.getAttribute(t)}function D(t,e){document.documentElement.setAttribute(t,e)}var k="--carotinnovel--slide-pad-position-";var E=function(){function t(t,e){this.joystickManager=null,this.size="middle",this.slidePadArea=t,this.scrollManager=new h(e)}return t.prototype.movePosition=function(t){"left"!=t?this.move({top:"auto",right:"3em",bottom:"2em",left:"auto"}):this.move({top:"auto",right:"auto",bottom:"2em",left:"3em"})},t.prototype.move=function(t){var e=function(t){var e=[];for(var n in t){var i=t[n];i&&e.push({key:k+n,val:i})}return e}(t);0!=e.length&&e.forEach(function(t){y(t)})},t.prototype.changeSize=function(t){this.size!=t&&(this.hide(),document.documentElement.setAttribute("data-slide-pad-size",t),this.show())},t.prototype.show=function(){this.joystickManager||this.add(this.slidePadArea.scrollWidth),this.slidePadArea.classList.remove("hidden")},t.prototype.hide=function(){this.joystickManager&&(this.joystickManager.destroy(),this.joystickManager=null),this.slidePadArea.classList.add("hidden")},t.prototype.add=function(t){var e=this;this.joystickManager=m.a.create({zone:this.slidePadArea,color:"white",size:2*t,position:{left:"50%",top:"50%"},mode:"static",lockY:!0,restOpacity:.8}),this.joystickManager.on("move",function(n,i){e.scrollManager.setSpeed(i,t)}),this.joystickManager.on("start",function(){e.scrollManager.start()}),this.joystickManager.on("end",function(){e.scrollManager.stop()})},t}(),C="carotin_novel",j="data-style-theme",P="data-style-font",A=n(4),I=n.n(A),T=n(1),L=n.n(T),M=n(0),N=n.n(M),F=n(10),R=n.n(F);function z(t){return t.namespace==B?t.id:t.namespace+"-"+t.id}var $=function(){function t(t){this.version=t.version,this.namespace=t.namespace,this.id=t.id,this.name=t.name,this.description=t.description,this.author=t.author,this.href=t.href,this.license=t.license,this.data=t.data}return Object.defineProperty(t.prototype,"identifier",{get:function(){return z(this)},enumerable:!0,configurable:!0}),t.prototype.getValue=function(t){var e=V.default.theme;return this.data[t]||(e?e.data[t]:"")},t.prototype.getColor=function(){return{background:"rgba("+this.getValue("background-base")+", "+this.getValue("background-base-a")+")",text:"rgba("+this.getValue("text-base")+", "+this.getValue("text-base-a")+")"}},t}();function W(t){return new $({version:t["meta-theme-version"]||"",namespace:t["meta-theme-namespace"]||"",id:t["meta-theme-id"]||"",name:t["meta-theme-name"]||"",description:t["meta-theme-description"]||"",author:t["meta-theme-author"]||"",href:t["meta-theme-href"]||"",license:t["meta-theme-license"]||"",data:t})}var q,B="carotin_novel",V=new(function(){function t(){this._authorDefault=S(j)||"",this._themes=[],this._defaultIndex=-1,this._authorDefaultIndex=-1,this.load()}return Object.defineProperty(t.prototype,"themes",{get:function(){return this._themes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"default",{get:function(){return{index:this._defaultIndex,theme:this._themes[this._defaultIndex]}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorDefault",{get:function(){return{index:this._authorDefaultIndex,theme:this._authorDefaultIndex>=0?this._themes[this._authorDefaultIndex]:null}},enumerable:!0,configurable:!0}),t.prototype.getTheme=function(t,e){for(var n=0;n<this._themes.length;n++)if(this._themes[n].namespace==t&&this._themes[n].id==e)return{index:n,theme:this._themes[n]};return{index:-1,theme:null}},t.prototype.apply=function(t){D(j,t.identifer)},t.prototype.load=function(){this._themes=[];for(var t=x(j),e=0;e<t.length;e++){var n=O(t[e].rules);this._themes.push(W(n))}this._defaultIndex=0,this._authorDefaultIndex=-1;for(e=0;e<this._themes.length;e++){var i=this._themes[e];i.identifier===this._authorDefault&&(this._authorDefaultIndex=e),i.namespace==B&&"default"==i.id&&(this._defaultIndex=e)}},t}());N.a.addPlugin(R.a);var X=((q={})[C]={version:"0.0.1",config:{update:(new Date).getTime(),slidepad:{position:"right"},theme:{id:"default",namespace:B},font:{id:"serif"}},works:{}},q);var Y=new(function(){function t(){this.emptyInStorage=!1,this.saveQueueId=-1,this.cache=this.load()}return Object.defineProperty(t.prototype,"config",{get:function(){return this.cache.config},enumerable:!0,configurable:!0}),t.prototype.getWork=function(t){return Object.hasOwnProperty.call(this.cache.works,t)?this.cache.works[t]:null},t.prototype.update=function(t){var e=L()(this.cache,t);I()(this.cache,e)||this.save(e)},t.prototype.updateWork=function(t,e){var n,i=L()(this.cache,{works:(n={},n[t]=e,n)});this.save(i)},t.prototype.updateConfig=function(t){var e=L()(this.cache,{config:t});this.save(e)},t.prototype.save=function(t){var e=this;this.cache=t,window.clearTimeout(this.saveQueueId),this.saveQueueId=window.setTimeout(function(){N.a.set(C,e.cache)},100)},t.prototype.load=function(){var t=N.a.get(C);t||(this.emptyInStorage=!0,N.a.defaults(X),t=N.a.get(C));var e,n=(e=t,L()(X[C],e));return I()(t,n)||this.save(n),n},t}()),H=function(){function t(t,e){this.articleId="",this.animationId=-1,this.saveQueueId=-1,this.prevState=null,this.wrapper=t,this.articleId=e}return t.prototype.start=function(){var t=this;window.cancelAnimationFrame(this.animationId);var e=function(){t.autoSave(),t.animationId=window.requestAnimationFrame(e)};this.animationId=window.requestAnimationFrame(e)},t.prototype.autoSave=function(){this.save()},t.prototype.restore=function(){var t=Y.getWork(this.articleId);return null!=t?this.doRestore(t):new Promise(function(t){t()})},t.prototype.doRestore=function(t){var e=this;return new Promise(function(n,i){var o=t.autosave;o?e.moveToBookmark(o).then(n).catch(i):n()})},t.prototype.moveToBookmark=function(t){for(var e=this,n=Array.from(this.wrapper.dom.querySelectorAll("div.page")),i=null,o=0;o<n.length;o++)if(n[o].getAttribute("data-page-id")==t.page){i=n[o];break}if(!i)return new Promise(function(t,e){e(new Error("Page not found."))});var r=Math.round(i.scrollWidth*t.scrolldepth);return new Promise(function(t){i&&(i.scrollIntoView(),i.offsetLeft),setTimeout(function(){e.wrapper.scrollToLeft(-1*r,!1),t()},300)})},t.prototype.save=function(){var t=this,e=this.getState();if(e.page&&null!=e.scrolldepth)if(null!=this.prevState){if(!this.isSame(this.prevState,e)){this.prevState=e;var n={autosave:e};window.clearTimeout(this.saveQueueId),this.saveQueueId=window.setTimeout(function(){Y.updateWork(t.articleId,n)},500)}}else this.prevState=e},t.prototype.isSame=function(t,e){return t.page==e.page&&t.scrolldepth==e.scrolldepth},t.prototype.getRightTopElement=function(){for(var t=document.elementFromPoint(window.innerWidth-40,0);t&&t.parentElement;){if("div"==t.tagName.toLowerCase()&&t.classList.contains("page"))return t;t=t.parentElement}return null},t.prototype.getState=function(){var t={page:"",scrolldepth:0,update:(new Date).getTime()},e=this.getRightTopElement();if(e){t.page=e.getAttribute("data-page-id")||"";var n=e.getBoundingClientRect().right-window.innerWidth;t.scrolldepth=n/e.scrollWidth}return t},t}();function J(t){var e=document.createElement("h2"),n=document.createElement("span");n.classList.add("line");var i=document.createElement("span");return i.classList.add("title"),i.textContent=t,e.appendChild(n),e.appendChild(i),e.appendChild(n.cloneNode()),e}function G(t){var e=document.createElement("div");return e.classList.add("menu-content"),t&&e.appendChild(J(t)),e}var U={id:"back",icon:"ion-md-arrow-back",title:"戻る"},Q=function(){function t(t){this.id=t.id,this.icon=t.icon,this.title=t.title}return t.prototype.toElement=function(t){var e=this,n=document.createElement("li");n.classList.add(this.id);var i=document.createElement("a");i.classList.add("button");var o=document.createElement("i");o.classList.add("icon"),o.classList.add(this.icon);var r=document.createElement("span");return r.textContent=this.title,i.appendChild(o),i.appendChild(r),n.appendChild(i),i.addEventListener("click",function(){t(e.id)}),n},t}(),Z=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},K=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Z(arguments[e]));return t},tt={id:"page",icon:"ion-md-bookmarks",title:"ページ"},et={id:"share",icon:"ion-md-share",title:"シェア"},nt=[{id:"settings",icon:"ion-md-settings",title:"設定"},{id:"help",icon:"ion-md-help-circle",title:"ヘルプ"},{id:"close",icon:"ion-md-close-circle",title:"閉じる"}];var it,ot=function(){function t(){this.wrapper=document.createElement("div")}return Object.defineProperty(t.prototype,"dom",{get:function(){return this.wrapper},enumerable:!0,configurable:!0}),t.prototype.constructSelect=function(t){t.select.id=t.id,t.select.addEventListener("change",function(e){if(e.target){var n=e.target;t.onchange(n)}}),t.options.forEach(function(e){var n=function(t){var e=document.createElement("option");return e.value=t.value,e.textContent=t.text,t.selected&&(e.selected=!0),Object.keys(t.data).forEach(function(n){e.setAttribute(n,t.data[n])}),Object.keys(t.styles).forEach(function(n){e.style.setProperty(n,t.styles[n])}),t.callback(e),e}(e);t.select.appendChild(n)})},t.createCheckBox=function(t){var e=document.createElement("div");e.classList.add("menu-checkbox");var n=document.createElement("input");n.type="checkbox",n.id=t.id;var i=document.createElement("label");return i.setAttribute("for",t.id),i.textContent=t.label,e.appendChild(n),e.appendChild(i),{div:e,check:n}},t}(),rt=(it=function(t,e){return(it=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}it(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});var st=function(t){function e(e){var n,i,o=t.call(this)||this;o.wrapper.classList.add("menu_center"),o.cautionDiv=(n=e.cautionLabel,(i=document.createElement("div")).classList.add("menu-caution"),i.appendChild(document.createTextNode("この作品には"+n+"が")),i.appendChild(document.createElement("br")),i.appendChild(document.createTextNode("設定されています。")),i);var r=ot.createCheckBox({id:e.checkboxId,label:"作品の設定を上書きする"});return o.checkDiv=r.div,o.overwriteCheck=r.check,o.overwriteCheck.addEventListener("change",function(){o._onChangeOverwriteCheck()}),o.wrapper.appendChild(o.cautionDiv),o.wrapper.appendChild(o.checkDiv),o.changeDiv=document.createElement("div"),o.changeDiv.classList.add("menu-change"),o.wrapper.appendChild(o.changeDiv),o._overwritable=e.overwritable,o._overwritable||(o.cautionDiv.style.display="none",o.checkDiv.style.display="none"),o}return rt(e,t),Object.defineProperty(e.prototype,"overwritable",{get:function(){return this._overwritable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overwrited",{get:function(){return this._overwritable&&this.overwriteCheck.checked},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overwrite",{set:function(t){this.overwriteCheck.checked=t,this.changeOverwriteView(t)},enumerable:!0,configurable:!0}),e.prototype._onChangeOverwriteCheck=function(){this.changeOverwriteView(this.overwrited),this.onChangeOverwriteCheck(this.overwrited)},e.prototype.changeOverwriteView=function(t){t?(this.cautionDiv.classList.add("off"),this.changeDiv.classList.remove("off")):(this.cautionDiv.classList.remove("off"),this.changeDiv.classList.add("off"))},e}(ot),at=function(t){this.id=t.id,this.name=t.name,this.family=t.family,this.description=t.description};function ct(t,e){return new at({id:e||"",name:t["font-name"]||"",family:t["font-family"]||"",description:t["font-description"]||""})}var ut=new(function(){function t(){this._authorDefault=S(P)||"",this._fonts=[],this._defaultIndex=-1,this._authorDefaultIndex=-1,this.load()}return Object.defineProperty(t.prototype,"fonts",{get:function(){return this._fonts},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"default",{get:function(){return{index:this._defaultIndex,font:this._fonts[this._defaultIndex]}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorDefault",{get:function(){return{index:this._authorDefaultIndex,font:this._authorDefaultIndex>=0?this._fonts[this._authorDefaultIndex]:null}},enumerable:!0,configurable:!0}),t.prototype.getFont=function(t){for(var e=0;e<this._fonts.length;e++)if(this._fonts[e].id==t)return{index:e,font:this._fonts[e]};return{index:-1,font:null}},t.prototype.apply=function(t){D(P,t)},t.prototype.load=function(){this._fonts=[];for(var t=x(P),e=0;e<t.length;e++){var n=O(t[e].rules);this._fonts.push(ct(n,t[e].dataValue))}this._defaultIndex=0,this._authorDefaultIndex=-1;for(e=0;e<this._fonts.length;e++){var i=this._fonts[e];i.id==this._authorDefault&&(this._authorDefaultIndex=e),"serif"==i.id&&(this._defaultIndex=e)}},t}());var lt=new(function(){function t(){this.articleId="",this.authorSetting={font:ut.authorDefault,theme:V.authorDefault},this.overwrite={theme:!1,font:!1},this.config=Y.config,this.userSetting={theme:V.getTheme(this.config.theme.namespace,this.config.theme.id),font:ut.getFont(this.config.font.id)}}return Object.defineProperty(t.prototype,"slidepad",{get:function(){return this.config.slidepad},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorDefault",{get:function(){return this.authorSetting},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"themes",{get:function(){return V.themes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this.reload(),this.authorSetting.theme.theme?this.overwrite.theme&&this.userSetting.theme.theme?this.userSetting.theme.theme:this.authorSetting.theme.theme:this.userSetting.theme.theme||V.default.theme},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fonts",{get:function(){return ut.fonts},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this.reload(),this.authorSetting.font.font?this.overwrite.font&&this.userSetting.font.font?this.userSetting.font.font:this.authorSetting.font.font:this.userSetting.font.font||ut.default.font},enumerable:!0,configurable:!0}),t.prototype.setArticleId=function(t){this.articleId=t},t.prototype.reload=function(){var t,e;this.overwrite=(t=this.articleId,(e=Y.getWork(t))&&e.styles?{theme:e.styles.overwriteTheme,font:e.styles.overwriteFont}:{theme:!1,font:!1}),this.config=Y.config,this.userSetting={theme:V.getTheme(this.config.theme.namespace,this.config.theme.id),font:ut.getFont(this.config.font.id)}},t}()),pt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),dt=function(t){function e(){var e=t.call(this,{cautionLabel:"テーマ",checkboxId:"overwrite-theme",overwritable:lt.authorDefault.theme.index>=0})||this;return e.select=document.createElement("select"),e.sampleDiv=document.createElement("div"),e.constructChangeDiv(),e}return pt(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){var t={id:"",namespace:""};if(this.select.selectedOptions.length<1)return t;var e=this.select.selectedOptions[0],n=e.getAttribute("data-theme-id"),i=e.getAttribute("data-theme-namespace");return n&&i?{id:n,namespace:i}:t},enumerable:!0,configurable:!0}),e.prototype.onChangeOverwriteCheck=function(){},e.prototype.setSample=function(t){if(this.sampleDiv.innerHTML="",this.sampleDiv.textContent+=t.description,t.namespace!=B){var e=document.createElement("span");if(e.classList.add("author"),e.textContent+="作者：",t.href.length>0){var n=document.createElement("a");n.target="_blank",n.href=t.href,n.textContent=t.author,e.appendChild(n)}else e.textContent+=t.author;this.sampleDiv.appendChild(e)}var i=t.getColor();this.sampleDiv.style.backgroundColor=i.background,this.sampleDiv.style.color=i.text},e.prototype.constructChangeDiv=function(){var t=this;this.sampleDiv.id="theme_sample";var e=Y.config.theme,n=lt.themes.map(function(t){var n;return{value:t.id,text:t.name,data:(n={},n["data-theme-namespace"]=t.namespace,n["data-theme-id"]=t.id,n),selected:t.id===e.id&&t.namespace===e.namespace,styles:{},callback:function(){}}});this.constructSelect({select:this.select,id:"theme_select",onchange:function(e){t.setSample(lt.themes[e.selectedIndex])},options:n}),this.changeDiv.appendChild(this.select),this.changeDiv.appendChild(this.sampleDiv);var i=this.selected,o=V.getTheme(i.namespace,i.id);o.theme&&this.setSample(o.theme)},e}(st),ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ft=function(t){function e(){var e=t.call(this,{cautionLabel:"フォント",checkboxId:"overwrite-font",overwritable:lt.authorDefault.font.index>=0})||this;return e.select=document.createElement("select"),e.constructChangeDiv(),e}return ht(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){var t=this.select.selectedOptions;return t.length<1?{id:""}:{id:t[0].value}},enumerable:!0,configurable:!0}),e.prototype.onChangeOverwriteCheck=function(){},e.prototype.constructChangeDiv=function(){var t=this,e=Y.config.font,n=function(e){t.select.style.fontFamily=e.style.fontFamily},i=function(){},o=lt.fonts.map(function(t){return{value:t.id,text:t.name,data:{},selected:t.id===e.id,styles:{"font-family":t.family},callback:t.id===e.id?n:i}});this.constructSelect({select:this.select,id:"font_select",onchange:function(e){t.select.style.fontFamily=e.selectedOptions[0].style.fontFamily},options:o}),this.changeDiv.appendChild(this.select)},e}(st);var mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),yt=function(t){function e(){var e=t.call(this)||this;e.wrapper.classList.add("slidepad_select"),e.radios=[];var n=Y.config.slidepad.position;return[{id:"left",label:"左"},{id:"none",label:"なし"},{id:"right",label:"右"}].forEach(function(t){var i=document.createElement("div"),o=document.createElement("input");o.type="radio",o.name="slidepad_radio",o.value=t.id,o.id="slidepad_radio_"+t.id,t.id==n&&(o.checked=!0),i.appendChild(o),e.radios.push(o);var r=document.createElement("label");r.textContent=t.label,r.setAttribute("for","slidepad_radio_"+t.id),i.appendChild(r),e.wrapper.appendChild(i)}),e}return mt(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){for(var t=0;t<this.radios.length;t++){var e=this.radios[t];if(e.checked&&("right"==(n=e.value)||"left"==n||"none"==n))return e.value}var n;return"right"},enumerable:!0,configurable:!0}),e}(ot),gt={id:"back",icon:"ion-md-close-circle",title:"キャンセル"},vt={id:"save",icon:"ion-md-checkmark-circle-outline",title:"保存"};var bt=function(){function t(t){var e=this;this.articleId=t.articleId;var n,i,o=(n=this.articleId,(i=Y.getWork(n))&&i.styles?{theme:i.styles.overwriteTheme,font:i.styles.overwriteFont}:{theme:!1,font:!1});this.configRootDom=G(),this.configRootDom.classList.add("menu-settings"),this.configRootDom.appendChild(J("スライドパッド")),this.slidepadSettings=new yt,this.configRootDom.appendChild(this.slidepadSettings.dom),this.configRootDom.appendChild(J("テーマ")),this.themeSettings=new dt,this.themeSettings.overwritable&&(this.themeSettings.overwrite=o.theme),this.configRootDom.appendChild(this.themeSettings.dom),this.configRootDom.appendChild(J("フォント")),this.fontSettings=new ft,this.fontSettings.overwritable&&(this.fontSettings.overwrite=o.font),this.configRootDom.appendChild(this.fontSettings.dom),this.controlsDom=function(t){var e=document.createElement("div");e.classList.add("menu_center");var n=document.createElement("ul");n.classList.add("menu_item"),n.classList.add("control");var i=new Q(gt),o=new Q(vt);return n.appendChild(o.toElement(t)),n.appendChild(i.toElement(t)),e.appendChild(n),e}(function(n){"save"==n&&e.save(),t.callback(n)}),this.configRootDom.appendChild(this.controlsDom)}return Object.defineProperty(t.prototype,"dom",{get:function(){return this.configRootDom},enumerable:!0,configurable:!0}),t.prototype.save=function(){var t={update:(new Date).getTime(),slidepad:{position:this.slidepadSettings.selected},theme:this.themeSettings.selected,font:this.fontSettings.selected};Y.updateConfig(t);var e={styles:{overwriteTheme:this.themeSettings.overwrited,overwriteFont:this.fontSettings.overwrited}};Y.updateWork(this.articleId,e)},t}(),wt=function(){function t(t){var e,n,i,o,r=this;this.app=t.app,this.pages=[],n=document.head.querySelectorAll("link"),i=!1,o=!1,n.forEach(function(t){"stylesheet"==t.rel.toLowerCase()&&(t.href.indexOf("ionicons")>=0&&(i=!0),t.href.indexOf("fonts.googleapis.com")>=0&&t.href.indexOf("Noto+Serif+JP")>=0&&(o=!0))}),i||((e=document.createElement("link")).rel="stylesheet",e.href="https://unpkg.com/ionicons@4.5.10-0/dist/css/ionicons.min.css",document.head.appendChild(e)),o||((e=document.createElement("link")).rel="stylesheet",e.href="https://fonts.googleapis.com/css?family=Noto+Serif+JP&display=swap",document.head.appendChild(e)),this.menuRootDom=document.createElement("div"),this.menuRootDom.classList.add("menu"),this.menuRootDom.appendChild(function(t){var e=document.createElement("div");e.classList.add("menu-back");var n=document.createElement("div");n.classList.add("menu-slide");var i=document.createElement("i");return i.classList.add("icon"),i.classList.add("ion-ios-arrow-forward"),n.appendChild(i),e.appendChild(n),n.addEventListener("click",t),e}(function(){r.open()})),this.menuContentWrapperDom=document.createElement("div"),this.menuContentWrapperDom.classList.add("menu-content-wrapper"),this.menuRootDom.appendChild(this.menuContentWrapperDom);var s=function(t){r.onClickItem(t)};this.topMenuDom=function(t,e,n){var i=G("MENU");i.classList.add("menu-top");var o=document.createElement("ul");return o.classList.add("menu_item"),K([t?tt:null,e?et:null],nt).forEach(function(t){if(t){var e=new Q(t);o.appendChild(e.toElement(n))}}),i.appendChild(o),i}(t.page.enable,t.share.enable,s),this.helpMenuDom=function(t){var e=G("操作方法");e.classList.add("menu-help");var n=document.createElement("ul");["右から左に読む縦書きのビューアーです。","マウスホイールの上下で横にスクロールできます。","画面上のスライドパッドで横にスクロールできます。","読み進めた位置は自動でブラウザに記憶されます。"].forEach(function(t){var e=document.createElement("li");e.textContent=t,n.appendChild(e)}),e.appendChild(n);var i=J("ビューアーについて");e.appendChild(i);var o=document.createElement("div");o.classList.add("menu_center");var r=document.createElement("a");r.innerHTML="Carotin Novel",r.href="https://noonworks.github.io/carotin-novel/",r.target="_blank",o.appendChild(r);var s=document.createElement("ul");s.classList.add("menu_item"),s.classList.add("control");var a=new Q(U);return s.appendChild(a.toElement(t)),o.appendChild(s),e.appendChild(o),e}(s),this.settings=new bt({callback:s,articleId:this.app.articleId}),this.settingsMenuDom=this.settings.dom,this.menuContentWrapperDom.appendChild(this.topMenuDom),this.menuContentWrapperDom.appendChild(this.helpMenuDom),this.menuContentWrapperDom.appendChild(this.settingsMenuDom),this.pages=[this.topMenuDom,this.helpMenuDom,this.settingsMenuDom],this.topMenuDom.classList.add("on")}return Object.defineProperty(t.prototype,"dom",{get:function(){return this.menuRootDom},enumerable:!0,configurable:!0}),t.prototype.open=function(){this.menuRootDom.classList.add("on")},t.prototype.close=function(){this.menuRootDom.classList.remove("on")},t.prototype.onClickItem=function(t){var e=this;switch(t){case"settings":this.doAfterRipple(function(){e.hideAll(),e.settingsMenuDom.classList.add("on")});break;case"help":this.doAfterRipple(function(){e.hideAll(),e.helpMenuDom.classList.add("on")});break;case"close":this.doAfterRipple(function(){e.close()});break;case"save":this.app.applyConfig(),this.doAfterRipple(function(){e.hideAll(),e.topMenuDom.classList.add("on")});break;case"back":this.doAfterRipple(function(){e.hideAll(),e.topMenuDom.classList.add("on")})}},t.prototype.hideAll=function(){this.pages.forEach(function(t){return t.classList.remove("on")})},t.prototype.doAfterRipple=function(t){setTimeout(t,200)},t}(),_t=function(){function t(){var t=document.querySelector("div.carotin_novel");if(!t)throw new Error("Could not get elements.");this.rootDom=t;var e=t.querySelector("div.content_wrapper");if(!e)throw new Error("Could not get elements.");this.wrapperDom=e,this._articleId=this.wrapperDom.getAttribute("data-article-id")||location.pathname,lt.setArticleId(this._articleId),this.wrapper=new i(this.wrapperDom);var n=this.rootDom.querySelector("div.bg_wrapper");n||((n=document.createElement("div")).classList.add("bg_wrapper"),this.rootDom.insertBefore(n,this.wrapperDom)),this.bgDom=n;var o=this.rootDom.querySelector("div.fg_wrapper");o||((o=document.createElement("div")).classList.add("fg_wrapper"),this.rootDom.insertBefore(o,this.wrapperDom)),this.fgDom=o;var r=this.rootDom.querySelector("div.slidepad");r||((r=document.createElement("div")).classList.add("slidepad"),this.rootDom.appendChild(r)),this.slidepadDom=r,this.slidepad=new E(this.slidepadDom,this.wrapper),this.slidepad.show();var s=this.fgDom.querySelector("div.loader");s||((s=document.createElement("div")).classList.add("loader"),this.fgDom.appendChild(s)),this.loaderDom=s,this.loader=new d(this.loaderDom),this.scrollManager=new H(this.wrapper,this._articleId),this.menu=new wt({app:this,enable:!0,page:{enable:!1},share:{enable:!1}}),this.rootDom.appendChild(this.menu.dom)}return Object.defineProperty(t.prototype,"articleId",{get:function(){return this._articleId},enumerable:!0,configurable:!0}),t.prototype.applyConfig=function(){V.apply({identifer:z(lt.theme)}),ut.apply(lt.font.id);var t=lt.slidepad.position;switch(this.slidepad.hide(),t){case"left":case"right":this.slidepad.movePosition(t),this.slidepad.show()}},t.prototype.start=function(){var t,e,n,i,o=this;this.loader.set("circle"),this.loader.show(),this.applyConfig(),t=this.wrapperDom,e=/^\s*$/,t.querySelectorAll("ruby").forEach(function(t){t.childNodes.forEach(function(n){n.nodeType==Node.TEXT_NODE&&n.nodeValue&&e.test(n.nodeValue)&&t.removeChild(n)})}),n=this.rootDom,(i=(new UAParser).getResult())&&i.browser&&i.device&&i.browser.name&&"chrome"==i.browser.name.toLowerCase()&&"mobile"!=i.device.type&&n.classList.add("custom_ruby"),function(t){var e=(new UAParser).getResult();if(!e||!e.browser||!e.browser.name||"edge"==e.browser.name.toLowerCase()){var n=document.createElement("span");n.style.opacity="0",n.style.position="fixed",t.appendChild(n)}}(this.wrapperDom),this.scrollManager.restore().then(function(){o.scrollManager.start(),o.loader.hide()}).catch(function(t){console.log(t),o.scrollManager.start(),o.loader.hide()})},t}();window.addEventListener("DOMContentLoaded",function(){(new _t).start()})}]);